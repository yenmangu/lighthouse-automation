{% extends "base.html" %}
{% load static %}
{% block content %}
  {% comment %} {% load crispy_forms_tags %} {% endcomment %}
  <div class="container-fluid container__index--top">
    <div class="row my-2">
      <div class="col col-md-4 branding">
        <h1>StudyStack</h1>
        <div class="tagline" role="doc-subtitle">
          <p class="text-muted">
            Learn <span class="font-bold">better</span>.
          </p>
          <p class="text-muted">
            Share <span class="font-bold">smarter</span>.
          </p>
          <p class="font-bold">Study together.</p>
        </div>
      </div>
      <div class="col col-md-8">
        <div class="mission-statement">
          <p>
            StudyStack is a community-powered platform where students share and discover study resources designed to support real learning, not just quick answers.
          </p>
          <p>
            From revision notes and guides to curated references and learning tools, StudyStack brings together resources created by students for students. Whether you are revising for an exam or exploring a new subject, you can find material shaped by real study experiences.
          </p>
        </div>
      </div>
    </div>
    <div class="row mt-4 cta">
      <div class="col-12">
        Discover the latest resources below, or <a href="{% url 'resources:subject_list' %}"><span>explore by subject.</span></a>
      </div>
    </div>
    <div class="row my-4 filters">
      <div class="col-12 col-filter">
        <h2 class="filter-heading h5 d-none d-lg-block">Filter resources</h2>
        <!-- Mobile: offcanvas activation -->
        <div class="d-lg-none">
          <button class="btn btn-outline-primary w-100"
                  type="button"
                  data-bs-toggle="offcanvas"
                  data-bs-target="#filtersOffcanvas"
                  aria-controls="filtersOffcanvas">Open Filters</button>
        </div>
        <!-- Desktop: inline filters form -->
        <div class="d-none d-lg-block">{% include "resources/partials/_filters_form.html" %}</div>
        <!-- Mobile: offcanvas filters form -->
        <div class="offcanvas offcanvas-start d-lg-none"
             tabindex="-1"
             id="filtersOffcanvas"
             aria-labelledby="filtersOffcanvasLabel">
          <div class="offcanvas-header">
            <h2 class="h5 mb-0" id="filtersOffcanvasLabel">Filter resources</h2>
            <button type="button"
                    class="btn-close"
                    data-bs-dismiss="offcanvas"
                    aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">{% include "resources/partials/_filters_form.html" %}</div>
        </div>
      </div>
    </div>
  </div>
  <div class="container-fluid resource-list">
    {% for resource in resource_list %}
      <div class="row mt-2">
        <div class="col-md-4">
          {% with image=resource.featured_image %}
            {% if image.public_id == "placeholder" %}
              <img src="{% static 'images/default.jpg' %}"
                   alt="placeholder image"
                   class="card-img-top">
            {% else %}
              <img src="{{ image.url }}" alt="{{ resource.title }}" class="card-img-top">
            {% endif %}
          {% endwith %}
        </div>
        <div class="col-md-8">
          {% if resource.status == "d" %}<span class="badge text-bg-secondary">Draft</span>{% endif %}
          <div class="card-title">
            <h4>
              <a href="{% url 'resources:resource_detail' slug=resource.slug %}"
                 class="resource_link">{{ resource.title }}</a>
            </h4>
          </div>
          <div class="card-description">{{ resource.description | safe }}</div>
        </div>
      </div>
    {% empty %}
      <div class="row mt-2">
        <div class="col-md-4">
          {% if request.GET %}
            <p class="empty">No study resources match your selected filters. Try widening your search.</p>
          {% else %}
            <p class="empty">
              No study resources have been added yet.
              You can add one using the
              <a href="{% url 'resources:create_resource' %}">Create Resource</a> form.
            </p>
          {% endif %}
        </div>
      </div>
    {% endfor %}
  </div>
  {% if is_paginated %}
    <nav aria-label="Page navigation">
      <ul class="pagination justify-content-center">
        {% if page_obj.has_previous %}
          <li class="page-item">
            <a href="?page={{ page_obj.previous_page_number }}" class="page-link">&laquo; PREV</a>
          </li>
        {% endif %}
        {% if page_obj.has_next %}
          <li class="page-item">
            <a href="?page={{ page_obj.next_page_number }}" class="page-link">NEXT &raquo;</a>
          </li>
        {% endif %}
      </ul>
    </nav>
  {% endif %}
  <div class="offcanvas offcanvas-start"
       tabindex="-1"
       id="offcanvasExample"
       aria-labelledby="offcanvasExampleLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="offcanvasFilters">Offcanvas</h5>
      <button type="button"
              class="btn-close"
              data-bs-dismiss="offcanvas"
              aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
      <div>
        Some text as placeholder. In real life you can have the elements you have chosen. Like, text, images, lists, etc.
      </div>
      <div class="dropdown mt-3">
        <button class="btn btn-secondary dropdown-toggle"
                type="button"
                data-bs-toggle="dropdown">Dropdown button</button>
        <ul class="dropdown-menu">
          <li>
            <a class="dropdown-item" href="#">Action</a>
          </li>
          <li>
            <a class="dropdown-item" href="#">Another action</a>
          </li>
          <li>
            <a class="dropdown-item" href="#">Something else here</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
{% endblock content %}
{% block extras %}
{% endblock extras %}
